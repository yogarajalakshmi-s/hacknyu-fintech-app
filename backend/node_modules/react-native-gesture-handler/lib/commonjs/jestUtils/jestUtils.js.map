{"version":3,"names":["_invariant","_interopRequireDefault","require","_reactNative","_FlingGestureHandler","_ForceTouchGestureHandler","_gesture","_handlersRegistry","_LongPressGestureHandler","_NativeViewGestureHandler","_PanGestureHandler","_PinchGestureHandler","_RotationGestureHandler","_TapGestureHandler","_State","_utils","e","__esModule","default","fireEvent","_element","_name","_data","_e","handlersDefaultEvents","flingHandlerName","x","y","absoluteX","absoluteY","numberOfPointers","forceTouchHandlerName","force","longPressHandlerName","duration","nativeViewHandlerName","pointerInside","panHandlerName","translationX","translationY","velocityX","velocityY","stylusData","undefined","pinchHandlerName","focalX","focalY","scale","velocity","rotationHandlerName","anchorX","anchorY","rotation","tapHandlerName","isGesture","componentOrGesture","BaseGesture","wrapWithNativeEvent","event","nativeEvent","fillOldStateChanges","previousEvent","currentEvent","isFirstEvent","oldState","State","UNDETERMINED","isGestureStateEvent","state","validateStateTransitions","stringify","JSON","errorMsgWithBothEvents","description","errorMsgWithCurrentEvent","invariant","hasProperty","BEGAN","fillMissingDefaultsFor","handlerType","handlerTag","isDiscreteHandler","fillMissingStatesTransitions","events","_events2","_events$","_events","lastEvent","length","firstEvent","shouldDuplicateFirstEvent","hasState","duplicated","unshift","shouldDuplicateLastEvent","END","FAILED","CANCELLED","push","isWithoutState","noEventsLeft","trueFn","fillEventsForCurrentState","shouldConsumeEvent","shouldTransitionToNextState","peekCurrentEvent","_events$2","peekNextEvent","_events$3","consumeCurrentEvent","shift","nextEvent","currentRequiredState","REQUIRED_EVENTS","currentStateIdx","eventData","shouldUseEvent","transformedEvents","ACTIVE","hasAllStates","iterations","nextRequiredState","getHandlerData","gesture","emitEvent","eventName","args","DeviceEventEmitter","emit","handlerName","enabled","config","gestureHandlerComponent","props","fireGestureHandler","eventList","_","map","withPrevAndCurrent","lastSentEvent","hasChangedState","getByGestureTestId","testID","handler","findHandlerByTestID","Error"],"sources":["jestUtils.ts"],"sourcesContent":["import invariant from 'invariant';\nimport { DeviceEventEmitter } from 'react-native';\nimport { ReactTestInstance } from 'react-test-renderer';\nimport {\n  FlingGestureHandler,\n  flingHandlerName,\n} from '../handlers/FlingGestureHandler';\nimport {\n  ForceTouchGestureHandler,\n  forceTouchHandlerName,\n} from '../handlers/ForceTouchGestureHandler';\nimport {\n  BaseGestureHandlerProps,\n  GestureEvent,\n  HandlerStateChangeEvent,\n} from '../handlers/gestureHandlerCommon';\nimport { FlingGesture } from '../handlers/gestures/flingGesture';\nimport { ForceTouchGesture } from '../handlers/gestures/forceTouchGesture';\nimport { BaseGesture, GestureType } from '../handlers/gestures/gesture';\nimport { LongPressGesture } from '../handlers/gestures/longPressGesture';\nimport { NativeGesture } from '../handlers/gestures/nativeGesture';\nimport { PanGesture } from '../handlers/gestures/panGesture';\nimport { PinchGesture } from '../handlers/gestures/pinchGesture';\nimport { RotationGesture } from '../handlers/gestures/rotationGesture';\nimport { TapGesture } from '../handlers/gestures/tapGesture';\nimport { findHandlerByTestID } from '../handlers/handlersRegistry';\nimport {\n  LongPressGestureHandler,\n  longPressHandlerName,\n} from '../handlers/LongPressGestureHandler';\nimport type {\n  FlingGestureHandlerEventPayload,\n  ForceTouchGestureHandlerEventPayload,\n  LongPressGestureHandlerEventPayload,\n  NativeViewGestureHandlerPayload,\n  PanGestureHandlerEventPayload,\n  PinchGestureHandlerEventPayload,\n  RotationGestureHandlerEventPayload,\n  TapGestureHandlerEventPayload,\n} from '../handlers/GestureHandlerEventPayload';\nimport {\n  NativeViewGestureHandler,\n  nativeViewHandlerName,\n} from '../handlers/NativeViewGestureHandler';\nimport {\n  PanGestureHandler,\n  panHandlerName,\n} from '../handlers/PanGestureHandler';\nimport {\n  PinchGestureHandler,\n  pinchHandlerName,\n} from '../handlers/PinchGestureHandler';\nimport {\n  RotationGestureHandler,\n  rotationHandlerName,\n} from '../handlers/RotationGestureHandler';\nimport {\n  TapGestureHandler,\n  tapHandlerName,\n} from '../handlers/TapGestureHandler';\nimport { State } from '../State';\nimport { hasProperty, withPrevAndCurrent } from '../utils';\n\n// Load fireEvent conditionally, so RNGH may be used in setups without testing-library\nlet fireEvent = (\n  _element: ReactTestInstance,\n  _name: string,\n  ..._data: any[]\n) => {\n  // NOOP\n};\n\ntry {\n  // eslint-disable-next-line @typescript-eslint/no-var-requires\n  fireEvent = require('@testing-library/react-native').fireEvent;\n} catch (_e) {\n  // Do nothing if not available\n}\n\ntype GestureHandlerTestEvent<\n  TEventPayload extends Record<string, unknown> = Record<string, unknown>,\n> = (\n  | GestureEvent<TEventPayload>\n  | HandlerStateChangeEvent<TEventPayload>\n)['nativeEvent'];\n\ntype HandlerNames = keyof DefaultEventsMapping;\n\ntype WithNumberOfPointers<T> = {\n  [P in keyof T]: T[P] & { numberOfPointers: number };\n};\ntype DefaultEventsMapping = WithNumberOfPointers<{\n  [flingHandlerName]: FlingGestureHandlerEventPayload;\n  [forceTouchHandlerName]: ForceTouchGestureHandlerEventPayload;\n  [longPressHandlerName]: LongPressGestureHandlerEventPayload;\n  [nativeViewHandlerName]: NativeViewGestureHandlerPayload;\n  [panHandlerName]: PanGestureHandlerEventPayload;\n  [pinchHandlerName]: PinchGestureHandlerEventPayload;\n  [rotationHandlerName]: RotationGestureHandlerEventPayload;\n  [tapHandlerName]: TapGestureHandlerEventPayload;\n}>;\n\nconst handlersDefaultEvents: DefaultEventsMapping = {\n  [flingHandlerName]: {\n    x: 0,\n    y: 0,\n    absoluteX: 0,\n    absoluteY: 0,\n    numberOfPointers: 1,\n  },\n  [forceTouchHandlerName]: {\n    x: 0,\n    y: 0,\n    absoluteX: 0,\n    absoluteY: 0,\n    force: 1,\n    numberOfPointers: 1,\n  },\n  [longPressHandlerName]: {\n    x: 0,\n    y: 0,\n    absoluteX: 0,\n    absoluteY: 0,\n    duration: 100,\n    numberOfPointers: 1,\n  },\n  [nativeViewHandlerName]: {\n    pointerInside: true,\n    numberOfPointers: 1,\n  },\n  [panHandlerName]: {\n    x: 0,\n    y: 0,\n    absoluteX: 0,\n    absoluteY: 0,\n    translationX: 100,\n    translationY: 0,\n    velocityX: 3,\n    velocityY: 0,\n    numberOfPointers: 1,\n    stylusData: undefined,\n  },\n  [pinchHandlerName]: {\n    focalX: 0,\n    focalY: 0,\n    scale: 2,\n    velocity: 1,\n    numberOfPointers: 2,\n  },\n  [rotationHandlerName]: {\n    anchorX: 0,\n    anchorY: 0,\n    rotation: 3.14,\n    velocity: 2,\n    numberOfPointers: 2,\n  },\n  [tapHandlerName]: {\n    x: 0,\n    y: 0,\n    absoluteX: 0,\n    absoluteY: 0,\n    numberOfPointers: 1,\n  },\n};\n\nfunction isGesture(\n  componentOrGesture: ReactTestInstance | GestureType\n): componentOrGesture is GestureType {\n  return componentOrGesture instanceof BaseGesture;\n}\n\ninterface WrappedGestureHandlerTestEvent {\n  nativeEvent: GestureHandlerTestEvent;\n}\nfunction wrapWithNativeEvent(\n  event: GestureHandlerTestEvent\n): WrappedGestureHandlerTestEvent {\n  return { nativeEvent: event };\n}\n\nfunction fillOldStateChanges(\n  previousEvent: GestureHandlerTestEvent | null,\n  currentEvent: Omit<GestureHandlerTestEvent, 'oldState'>\n): GestureHandlerTestEvent {\n  const isFirstEvent = previousEvent === null;\n  if (isFirstEvent) {\n    return {\n      oldState: State.UNDETERMINED,\n      ...currentEvent,\n    } as GestureHandlerTestEvent;\n  }\n\n  const isGestureStateEvent = previousEvent.state !== currentEvent.state;\n  if (isGestureStateEvent) {\n    return {\n      oldState: previousEvent?.state,\n      ...currentEvent,\n    } as GestureHandlerTestEvent;\n  } else {\n    return currentEvent as GestureHandlerTestEvent;\n  }\n}\n\ntype EventWithStates = Partial<\n  Pick<GestureHandlerTestEvent, 'oldState' | 'state'>\n>;\nfunction validateStateTransitions(\n  previousEvent: EventWithStates | null,\n  currentEvent: EventWithStates\n) {\n  function stringify(event: Record<string, unknown> | null) {\n    return JSON.stringify(event, null, 2);\n  }\n  function errorMsgWithBothEvents(description: string) {\n    return `${description}, invalid event: ${stringify(\n      currentEvent\n    )}, previous event: ${stringify(previousEvent)}`;\n  }\n\n  function errorMsgWithCurrentEvent(description: string) {\n    return `${description}, invalid event: ${stringify(currentEvent)}`;\n  }\n\n  invariant(\n    hasProperty(currentEvent, 'state'),\n    errorMsgWithCurrentEvent('every event must have state')\n  );\n\n  const isFirstEvent = previousEvent === null;\n  if (isFirstEvent) {\n    invariant(\n      currentEvent.state === State.BEGAN,\n      errorMsgWithCurrentEvent('first event must have BEGAN state')\n    );\n  }\n\n  if (previousEvent !== null) {\n    if (previousEvent.state !== currentEvent.state) {\n      invariant(\n        hasProperty(currentEvent, 'oldState'),\n        errorMsgWithCurrentEvent(\n          'when state changes, oldState field should be present'\n        )\n      );\n      invariant(\n        currentEvent.oldState === previousEvent.state,\n        errorMsgWithBothEvents(\n          \"when state changes, oldState should be the same as previous event' state\"\n        )\n      );\n    }\n  }\n\n  return currentEvent;\n}\n\ntype EventWithoutStates = Omit<GestureHandlerTestEvent, 'oldState' | 'state'>;\ninterface HandlerInfo {\n  handlerType: HandlerNames;\n  handlerTag: number;\n}\nfunction fillMissingDefaultsFor({\n  handlerType,\n  handlerTag,\n}: HandlerInfo): (\n  event: Partial<GestureHandlerTestEvent>\n) => EventWithoutStates {\n  return (event) => {\n    return {\n      ...handlersDefaultEvents[handlerType],\n      ...event,\n      handlerTag,\n    };\n  };\n}\n\nfunction isDiscreteHandler(handlerType: HandlerNames) {\n  return (\n    handlerType === 'TapGestureHandler' ||\n    handlerType === 'LongPressGestureHandler'\n  );\n}\n\nfunction fillMissingStatesTransitions(\n  events: EventWithoutStates[],\n  isDiscreteHandler: boolean\n): EventWithoutStates[] {\n  type Event = EventWithoutStates | null;\n  const _events = [...events];\n  const lastEvent = _events[_events.length - 1] ?? null;\n  const firstEvent = _events[0] ?? null;\n\n  const shouldDuplicateFirstEvent =\n    !isDiscreteHandler && !hasState(State.BEGAN)(firstEvent);\n  if (shouldDuplicateFirstEvent) {\n    const duplicated = { ...firstEvent, state: State.BEGAN };\n    // @ts-ignore badly typed, property may exist and we don't want to copy it\n    delete duplicated.oldState;\n    _events.unshift(duplicated);\n  }\n\n  const shouldDuplicateLastEvent =\n    !hasState(State.END)(lastEvent) ||\n    !hasState(State.FAILED)(lastEvent) ||\n    !hasState(State.CANCELLED)(lastEvent);\n\n  if (shouldDuplicateLastEvent) {\n    const duplicated = { ...lastEvent, state: State.END };\n    // @ts-ignore badly typed, property may exist and we don't want to copy it\n    delete duplicated.oldState;\n    _events.push(duplicated);\n  }\n\n  function isWithoutState(event: Event) {\n    return event !== null && !hasProperty(event, 'state');\n  }\n  function hasState(state: State) {\n    return (event: Event) => event !== null && event.state === state;\n  }\n  function noEventsLeft(event: Event) {\n    return event === null;\n  }\n\n  function trueFn() {\n    return true;\n  }\n  interface Args {\n    shouldConsumeEvent?: (event: Event) => boolean;\n    shouldTransitionToNextState?: (nextEvent: Event) => boolean;\n  }\n  function fillEventsForCurrentState({\n    shouldConsumeEvent = trueFn,\n    shouldTransitionToNextState = trueFn,\n  }: Args) {\n    function peekCurrentEvent(): Event {\n      return _events[0] ?? null;\n    }\n    function peekNextEvent(): Event {\n      return _events[1] ?? null;\n    }\n    function consumeCurrentEvent() {\n      _events.shift();\n    }\n    const currentEvent = peekCurrentEvent();\n    const nextEvent = peekNextEvent();\n    const currentRequiredState = REQUIRED_EVENTS[currentStateIdx];\n\n    let eventData = {};\n    const shouldUseEvent = shouldConsumeEvent(currentEvent);\n    if (shouldUseEvent) {\n      eventData = currentEvent!;\n      consumeCurrentEvent();\n    }\n    transformedEvents.push({ state: currentRequiredState, ...eventData });\n    if (shouldTransitionToNextState(nextEvent)) {\n      currentStateIdx++;\n    }\n  }\n\n  const REQUIRED_EVENTS = [State.BEGAN, State.ACTIVE, State.END];\n\n  let currentStateIdx = 0;\n  const transformedEvents: EventWithoutStates[] = [];\n  let hasAllStates;\n  let iterations = 0;\n  do {\n    const nextRequiredState = REQUIRED_EVENTS[currentStateIdx];\n    if (nextRequiredState === State.BEGAN) {\n      fillEventsForCurrentState({\n        shouldConsumeEvent: (e: Event) =>\n          isWithoutState(e) || hasState(State.BEGAN)(e),\n      });\n    } else if (nextRequiredState === State.ACTIVE) {\n      const shouldConsumeEvent = (e: Event) =>\n        isWithoutState(e) || hasState(State.ACTIVE)(e);\n      const shouldTransitionToNextState = (nextEvent: Event) =>\n        noEventsLeft(nextEvent) ||\n        hasState(State.END)(nextEvent) ||\n        hasState(State.FAILED)(nextEvent) ||\n        hasState(State.CANCELLED)(nextEvent);\n\n      fillEventsForCurrentState({\n        shouldConsumeEvent,\n        shouldTransitionToNextState,\n      });\n    } else if (nextRequiredState === State.END) {\n      fillEventsForCurrentState({});\n    }\n    hasAllStates = currentStateIdx === REQUIRED_EVENTS.length;\n\n    invariant(\n      iterations++ <= 500,\n      'exceeded max number of iterations, please report a bug in RNGH repository with your test case'\n    );\n  } while (!hasAllStates);\n\n  return transformedEvents;\n}\n\ntype EventEmitter = (\n  eventName: string,\n  args: { nativeEvent: GestureHandlerTestEvent }\n) => void;\ninterface HandlerData {\n  emitEvent: EventEmitter;\n  handlerType: HandlerNames;\n  handlerTag: number;\n  enabled: boolean | undefined;\n}\nfunction getHandlerData(\n  componentOrGesture: ReactTestInstance | GestureType\n): HandlerData {\n  if (isGesture(componentOrGesture)) {\n    const gesture = componentOrGesture;\n    return {\n      emitEvent: (eventName, args) => {\n        DeviceEventEmitter.emit(eventName, args.nativeEvent);\n      },\n      handlerType: gesture.handlerName as HandlerNames,\n      handlerTag: gesture.handlerTag,\n      enabled: gesture.config.enabled,\n    };\n  }\n  const gestureHandlerComponent = componentOrGesture;\n  return {\n    emitEvent: (eventName, args) => {\n      fireEvent(gestureHandlerComponent, eventName, args);\n    },\n    handlerType: gestureHandlerComponent.props.handlerType as HandlerNames,\n    handlerTag: gestureHandlerComponent.props.handlerTag as number,\n    enabled: gestureHandlerComponent.props.enabled,\n  };\n}\ntype AllGestures =\n  | TapGesture\n  | PanGesture\n  | LongPressGesture\n  | RotationGesture\n  | PinchGesture\n  | FlingGesture\n  | ForceTouchGesture\n  | NativeGesture;\n\ntype AllHandlers =\n  | TapGestureHandler\n  | PanGestureHandler\n  | LongPressGestureHandler\n  | RotationGestureHandler\n  | PinchGestureHandler\n  | FlingGestureHandler\n  | ForceTouchGestureHandler\n  | NativeViewGestureHandler;\n\n// prettier-ignore\ntype ClassComponentConstructor<P> = new (props: P) => React.Component<P, any, any>;\n\ntype ExtractPayloadFromProps<T> =\n  T extends BaseGestureHandlerProps<infer TPayload> ? TPayload : never;\n\ntype ExtractConfig<T> =\n  T extends BaseGesture<infer TGesturePayload>\n    ? TGesturePayload\n    : T extends ClassComponentConstructor<infer THandlerProps>\n      ? ExtractPayloadFromProps<THandlerProps>\n      : Record<string, unknown>;\n\nexport function fireGestureHandler<THandler extends AllGestures | AllHandlers>(\n  componentOrGesture: ReactTestInstance | GestureType,\n  eventList: Partial<GestureHandlerTestEvent<ExtractConfig<THandler>>>[] = []\n): void {\n  const { emitEvent, handlerType, handlerTag, enabled } =\n    getHandlerData(componentOrGesture);\n\n  if (enabled === false) {\n    return;\n  }\n\n  let _ = fillMissingStatesTransitions(\n    eventList,\n    isDiscreteHandler(handlerType)\n  );\n  _ = _.map(fillMissingDefaultsFor({ handlerTag, handlerType }));\n  _ = withPrevAndCurrent(_, fillOldStateChanges);\n  _ = withPrevAndCurrent(_, validateStateTransitions);\n  // @ts-ignore TODO\n  _ = _.map(wrapWithNativeEvent);\n\n  const events = _ as unknown as WrappedGestureHandlerTestEvent[];\n\n  const firstEvent = events.shift()!;\n\n  emitEvent('onGestureHandlerStateChange', firstEvent);\n  let lastSentEvent = firstEvent;\n  for (const event of events) {\n    const hasChangedState =\n      lastSentEvent.nativeEvent.state !== event.nativeEvent.state;\n\n    if (hasChangedState) {\n      emitEvent('onGestureHandlerStateChange', event);\n    } else {\n      emitEvent('onGestureHandlerEvent', event);\n    }\n    lastSentEvent = event;\n  }\n}\n\nexport function getByGestureTestId(testID: string) {\n  const handler = findHandlerByTestID(testID);\n  if (handler === null) {\n    throw new Error(`Handler with id: '${testID}' cannot be found`);\n  }\n  return handler;\n}\n"],"mappings":";;;;;;;AAAA,IAAAA,UAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,YAAA,GAAAD,OAAA;AAEA,IAAAE,oBAAA,GAAAF,OAAA;AAIA,IAAAG,yBAAA,GAAAH,OAAA;AAWA,IAAAI,QAAA,GAAAJ,OAAA;AAOA,IAAAK,iBAAA,GAAAL,OAAA;AACA,IAAAM,wBAAA,GAAAN,OAAA;AAcA,IAAAO,yBAAA,GAAAP,OAAA;AAIA,IAAAQ,kBAAA,GAAAR,OAAA;AAIA,IAAAS,oBAAA,GAAAT,OAAA;AAIA,IAAAU,uBAAA,GAAAV,OAAA;AAIA,IAAAW,kBAAA,GAAAX,OAAA;AAIA,IAAAY,MAAA,GAAAZ,OAAA;AACA,IAAAa,MAAA,GAAAb,OAAA;AAA2D,SAAAD,uBAAAe,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE3D;AACA,IAAIG,SAAS,GAAGA,CACdC,QAA2B,EAC3BC,KAAa,EACb,GAAGC,KAAY,KACZ;EACH;AAAA,CACD;AAED,IAAI;EACF;EACAH,SAAS,GAAGjB,OAAO,CAAC,+BAA+B,CAAC,CAACiB,SAAS;AAChE,CAAC,CAAC,OAAOI,EAAE,EAAE;EACX;AAAA;AA0BF,MAAMC,qBAA2C,GAAG;EAClD,CAACC,qCAAgB,GAAG;IAClBC,CAAC,EAAE,CAAC;IACJC,CAAC,EAAE,CAAC;IACJC,SAAS,EAAE,CAAC;IACZC,SAAS,EAAE,CAAC;IACZC,gBAAgB,EAAE;EACpB,CAAC;EACD,CAACC,+CAAqB,GAAG;IACvBL,CAAC,EAAE,CAAC;IACJC,CAAC,EAAE,CAAC;IACJC,SAAS,EAAE,CAAC;IACZC,SAAS,EAAE,CAAC;IACZG,KAAK,EAAE,CAAC;IACRF,gBAAgB,EAAE;EACpB,CAAC;EACD,CAACG,6CAAoB,GAAG;IACtBP,CAAC,EAAE,CAAC;IACJC,CAAC,EAAE,CAAC;IACJC,SAAS,EAAE,CAAC;IACZC,SAAS,EAAE,CAAC;IACZK,QAAQ,EAAE,GAAG;IACbJ,gBAAgB,EAAE;EACpB,CAAC;EACD,CAACK,+CAAqB,GAAG;IACvBC,aAAa,EAAE,IAAI;IACnBN,gBAAgB,EAAE;EACpB,CAAC;EACD,CAACO,iCAAc,GAAG;IAChBX,CAAC,EAAE,CAAC;IACJC,CAAC,EAAE,CAAC;IACJC,SAAS,EAAE,CAAC;IACZC,SAAS,EAAE,CAAC;IACZS,YAAY,EAAE,GAAG;IACjBC,YAAY,EAAE,CAAC;IACfC,SAAS,EAAE,CAAC;IACZC,SAAS,EAAE,CAAC;IACZX,gBAAgB,EAAE,CAAC;IACnBY,UAAU,EAAEC;EACd,CAAC;EACD,CAACC,qCAAgB,GAAG;IAClBC,MAAM,EAAE,CAAC;IACTC,MAAM,EAAE,CAAC;IACTC,KAAK,EAAE,CAAC;IACRC,QAAQ,EAAE,CAAC;IACXlB,gBAAgB,EAAE;EACpB,CAAC;EACD,CAACmB,2CAAmB,GAAG;IACrBC,OAAO,EAAE,CAAC;IACVC,OAAO,EAAE,CAAC;IACVC,QAAQ,EAAE,IAAI;IACdJ,QAAQ,EAAE,CAAC;IACXlB,gBAAgB,EAAE;EACpB,CAAC;EACD,CAACuB,iCAAc,GAAG;IAChB3B,CAAC,EAAE,CAAC;IACJC,CAAC,EAAE,CAAC;IACJC,SAAS,EAAE,CAAC;IACZC,SAAS,EAAE,CAAC;IACZC,gBAAgB,EAAE;EACpB;AACF,CAAC;AAED,SAASwB,SAASA,CAChBC,kBAAmD,EAChB;EACnC,OAAOA,kBAAkB,YAAYC,oBAAW;AAClD;AAKA,SAASC,mBAAmBA,CAC1BC,KAA8B,EACE;EAChC,OAAO;IAAEC,WAAW,EAAED;EAAM,CAAC;AAC/B;AAEA,SAASE,mBAAmBA,CAC1BC,aAA6C,EAC7CC,YAAuD,EAC9B;EACzB,MAAMC,YAAY,GAAGF,aAAa,KAAK,IAAI;EAC3C,IAAIE,YAAY,EAAE;IAChB,OAAO;MACLC,QAAQ,EAAEC,YAAK,CAACC,YAAY;MAC5B,GAAGJ;IACL,CAAC;EACH;EAEA,MAAMK,mBAAmB,GAAGN,aAAa,CAACO,KAAK,KAAKN,YAAY,CAACM,KAAK;EACtE,IAAID,mBAAmB,EAAE;IACvB,OAAO;MACLH,QAAQ,EAAEH,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEO,KAAK;MAC9B,GAAGN;IACL,CAAC;EACH,CAAC,MAAM;IACL,OAAOA,YAAY;EACrB;AACF;AAKA,SAASO,wBAAwBA,CAC/BR,aAAqC,EACrCC,YAA6B,EAC7B;EACA,SAASQ,SAASA,CAACZ,KAAqC,EAAE;IACxD,OAAOa,IAAI,CAACD,SAAS,CAACZ,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;EACvC;EACA,SAASc,sBAAsBA,CAACC,WAAmB,EAAE;IACnD,OAAO,GAAGA,WAAW,oBAAoBH,SAAS,CAChDR,YACF,CAAC,qBAAqBQ,SAAS,CAACT,aAAa,CAAC,EAAE;EAClD;EAEA,SAASa,wBAAwBA,CAACD,WAAmB,EAAE;IACrD,OAAO,GAAGA,WAAW,oBAAoBH,SAAS,CAACR,YAAY,CAAC,EAAE;EACpE;EAEA,IAAAa,kBAAS,EACP,IAAAC,kBAAW,EAACd,YAAY,EAAE,OAAO,CAAC,EAClCY,wBAAwB,CAAC,6BAA6B,CACxD,CAAC;EAED,MAAMX,YAAY,GAAGF,aAAa,KAAK,IAAI;EAC3C,IAAIE,YAAY,EAAE;IAChB,IAAAY,kBAAS,EACPb,YAAY,CAACM,KAAK,KAAKH,YAAK,CAACY,KAAK,EAClCH,wBAAwB,CAAC,mCAAmC,CAC9D,CAAC;EACH;EAEA,IAAIb,aAAa,KAAK,IAAI,EAAE;IAC1B,IAAIA,aAAa,CAACO,KAAK,KAAKN,YAAY,CAACM,KAAK,EAAE;MAC9C,IAAAO,kBAAS,EACP,IAAAC,kBAAW,EAACd,YAAY,EAAE,UAAU,CAAC,EACrCY,wBAAwB,CACtB,sDACF,CACF,CAAC;MACD,IAAAC,kBAAS,EACPb,YAAY,CAACE,QAAQ,KAAKH,aAAa,CAACO,KAAK,EAC7CI,sBAAsB,CACpB,0EACF,CACF,CAAC;IACH;EACF;EAEA,OAAOV,YAAY;AACrB;AAOA,SAASgB,sBAAsBA,CAAC;EAC9BC,WAAW;EACXC;AACW,CAAC,EAEU;EACtB,OAAQtB,KAAK,IAAK;IAChB,OAAO;MACL,GAAGlC,qBAAqB,CAACuD,WAAW,CAAC;MACrC,GAAGrB,KAAK;MACRsB;IACF,CAAC;EACH,CAAC;AACH;AAEA,SAASC,iBAAiBA,CAACF,WAAyB,EAAE;EACpD,OACEA,WAAW,KAAK,mBAAmB,IACnCA,WAAW,KAAK,yBAAyB;AAE7C;AAEA,SAASG,4BAA4BA,CACnCC,MAA4B,EAC5BF,iBAA0B,EACJ;EAAA,IAAAG,QAAA,EAAAC,QAAA;EAEtB,MAAMC,OAAO,GAAG,CAAC,GAAGH,MAAM,CAAC;EAC3B,MAAMI,SAAS,IAAAH,QAAA,GAAGE,OAAO,CAACA,OAAO,CAACE,MAAM,GAAG,CAAC,CAAC,cAAAJ,QAAA,cAAAA,QAAA,GAAI,IAAI;EACrD,MAAMK,UAAU,IAAAJ,QAAA,GAAGC,OAAO,CAAC,CAAC,CAAC,cAAAD,QAAA,cAAAA,QAAA,GAAI,IAAI;EAErC,MAAMK,yBAAyB,GAC7B,CAACT,iBAAiB,IAAI,CAACU,QAAQ,CAAC1B,YAAK,CAACY,KAAK,CAAC,CAACY,UAAU,CAAC;EAC1D,IAAIC,yBAAyB,EAAE;IAC7B,MAAME,UAAU,GAAG;MAAE,GAAGH,UAAU;MAAErB,KAAK,EAAEH,YAAK,CAACY;IAAM,CAAC;IACxD;IACA,OAAOe,UAAU,CAAC5B,QAAQ;IAC1BsB,OAAO,CAACO,OAAO,CAACD,UAAU,CAAC;EAC7B;EAEA,MAAME,wBAAwB,GAC5B,CAACH,QAAQ,CAAC1B,YAAK,CAAC8B,GAAG,CAAC,CAACR,SAAS,CAAC,IAC/B,CAACI,QAAQ,CAAC1B,YAAK,CAAC+B,MAAM,CAAC,CAACT,SAAS,CAAC,IAClC,CAACI,QAAQ,CAAC1B,YAAK,CAACgC,SAAS,CAAC,CAACV,SAAS,CAAC;EAEvC,IAAIO,wBAAwB,EAAE;IAC5B,MAAMF,UAAU,GAAG;MAAE,GAAGL,SAAS;MAAEnB,KAAK,EAAEH,YAAK,CAAC8B;IAAI,CAAC;IACrD;IACA,OAAOH,UAAU,CAAC5B,QAAQ;IAC1BsB,OAAO,CAACY,IAAI,CAACN,UAAU,CAAC;EAC1B;EAEA,SAASO,cAAcA,CAACzC,KAAY,EAAE;IACpC,OAAOA,KAAK,KAAK,IAAI,IAAI,CAAC,IAAAkB,kBAAW,EAAClB,KAAK,EAAE,OAAO,CAAC;EACvD;EACA,SAASiC,QAAQA,CAACvB,KAAY,EAAE;IAC9B,OAAQV,KAAY,IAAKA,KAAK,KAAK,IAAI,IAAIA,KAAK,CAACU,KAAK,KAAKA,KAAK;EAClE;EACA,SAASgC,YAAYA,CAAC1C,KAAY,EAAE;IAClC,OAAOA,KAAK,KAAK,IAAI;EACvB;EAEA,SAAS2C,MAAMA,CAAA,EAAG;IAChB,OAAO,IAAI;EACb;EAKA,SAASC,yBAAyBA,CAAC;IACjCC,kBAAkB,GAAGF,MAAM;IAC3BG,2BAA2B,GAAGH;EAC1B,CAAC,EAAE;IACP,SAASI,gBAAgBA,CAAA,EAAU;MAAA,IAAAC,SAAA;MACjC,QAAAA,SAAA,GAAOpB,OAAO,CAAC,CAAC,CAAC,cAAAoB,SAAA,cAAAA,SAAA,GAAI,IAAI;IAC3B;IACA,SAASC,aAAaA,CAAA,EAAU;MAAA,IAAAC,SAAA;MAC9B,QAAAA,SAAA,GAAOtB,OAAO,CAAC,CAAC,CAAC,cAAAsB,SAAA,cAAAA,SAAA,GAAI,IAAI;IAC3B;IACA,SAASC,mBAAmBA,CAAA,EAAG;MAC7BvB,OAAO,CAACwB,KAAK,CAAC,CAAC;IACjB;IACA,MAAMhD,YAAY,GAAG2C,gBAAgB,CAAC,CAAC;IACvC,MAAMM,SAAS,GAAGJ,aAAa,CAAC,CAAC;IACjC,MAAMK,oBAAoB,GAAGC,eAAe,CAACC,eAAe,CAAC;IAE7D,IAAIC,SAAS,GAAG,CAAC,CAAC;IAClB,MAAMC,cAAc,GAAGb,kBAAkB,CAACzC,YAAY,CAAC;IACvD,IAAIsD,cAAc,EAAE;MAClBD,SAAS,GAAGrD,YAAa;MACzB+C,mBAAmB,CAAC,CAAC;IACvB;IACAQ,iBAAiB,CAACnB,IAAI,CAAC;MAAE9B,KAAK,EAAE4C,oBAAoB;MAAE,GAAGG;IAAU,CAAC,CAAC;IACrE,IAAIX,2BAA2B,CAACO,SAAS,CAAC,EAAE;MAC1CG,eAAe,EAAE;IACnB;EACF;EAEA,MAAMD,eAAe,GAAG,CAAChD,YAAK,CAACY,KAAK,EAAEZ,YAAK,CAACqD,MAAM,EAAErD,YAAK,CAAC8B,GAAG,CAAC;EAE9D,IAAImB,eAAe,GAAG,CAAC;EACvB,MAAMG,iBAAuC,GAAG,EAAE;EAClD,IAAIE,YAAY;EAChB,IAAIC,UAAU,GAAG,CAAC;EAClB,GAAG;IACD,MAAMC,iBAAiB,GAAGR,eAAe,CAACC,eAAe,CAAC;IAC1D,IAAIO,iBAAiB,KAAKxD,YAAK,CAACY,KAAK,EAAE;MACrCyB,yBAAyB,CAAC;QACxBC,kBAAkB,EAAGvF,CAAQ,IAC3BmF,cAAc,CAACnF,CAAC,CAAC,IAAI2E,QAAQ,CAAC1B,YAAK,CAACY,KAAK,CAAC,CAAC7D,CAAC;MAChD,CAAC,CAAC;IACJ,CAAC,MAAM,IAAIyG,iBAAiB,KAAKxD,YAAK,CAACqD,MAAM,EAAE;MAC7C,MAAMf,kBAAkB,GAAIvF,CAAQ,IAClCmF,cAAc,CAACnF,CAAC,CAAC,IAAI2E,QAAQ,CAAC1B,YAAK,CAACqD,MAAM,CAAC,CAACtG,CAAC,CAAC;MAChD,MAAMwF,2BAA2B,GAAIO,SAAgB,IACnDX,YAAY,CAACW,SAAS,CAAC,IACvBpB,QAAQ,CAAC1B,YAAK,CAAC8B,GAAG,CAAC,CAACgB,SAAS,CAAC,IAC9BpB,QAAQ,CAAC1B,YAAK,CAAC+B,MAAM,CAAC,CAACe,SAAS,CAAC,IACjCpB,QAAQ,CAAC1B,YAAK,CAACgC,SAAS,CAAC,CAACc,SAAS,CAAC;MAEtCT,yBAAyB,CAAC;QACxBC,kBAAkB;QAClBC;MACF,CAAC,CAAC;IACJ,CAAC,MAAM,IAAIiB,iBAAiB,KAAKxD,YAAK,CAAC8B,GAAG,EAAE;MAC1CO,yBAAyB,CAAC,CAAC,CAAC,CAAC;IAC/B;IACAiB,YAAY,GAAGL,eAAe,KAAKD,eAAe,CAACzB,MAAM;IAEzD,IAAAb,kBAAS,EACP6C,UAAU,EAAE,IAAI,GAAG,EACnB,+FACF,CAAC;EACH,CAAC,QAAQ,CAACD,YAAY;EAEtB,OAAOF,iBAAiB;AAC1B;AAYA,SAASK,cAAcA,CACrBnE,kBAAmD,EACtC;EACb,IAAID,SAAS,CAACC,kBAAkB,CAAC,EAAE;IACjC,MAAMoE,OAAO,GAAGpE,kBAAkB;IAClC,OAAO;MACLqE,SAAS,EAAEA,CAACC,SAAS,EAAEC,IAAI,KAAK;QAC9BC,+BAAkB,CAACC,IAAI,CAACH,SAAS,EAAEC,IAAI,CAACnE,WAAW,CAAC;MACtD,CAAC;MACDoB,WAAW,EAAE4C,OAAO,CAACM,WAA2B;MAChDjD,UAAU,EAAE2C,OAAO,CAAC3C,UAAU;MAC9BkD,OAAO,EAAEP,OAAO,CAACQ,MAAM,CAACD;IAC1B,CAAC;EACH;EACA,MAAME,uBAAuB,GAAG7E,kBAAkB;EAClD,OAAO;IACLqE,SAAS,EAAEA,CAACC,SAAS,EAAEC,IAAI,KAAK;MAC9B3G,SAAS,CAACiH,uBAAuB,EAAEP,SAAS,EAAEC,IAAI,CAAC;IACrD,CAAC;IACD/C,WAAW,EAAEqD,uBAAuB,CAACC,KAAK,CAACtD,WAA2B;IACtEC,UAAU,EAAEoD,uBAAuB,CAACC,KAAK,CAACrD,UAAoB;IAC9DkD,OAAO,EAAEE,uBAAuB,CAACC,KAAK,CAACH;EACzC,CAAC;AACH;;AAqBA;;AAaO,SAASI,kBAAkBA,CAChC/E,kBAAmD,EACnDgF,SAAsE,GAAG,EAAE,EACrE;EACN,MAAM;IAAEX,SAAS;IAAE7C,WAAW;IAAEC,UAAU;IAAEkD;EAAQ,CAAC,GACnDR,cAAc,CAACnE,kBAAkB,CAAC;EAEpC,IAAI2E,OAAO,KAAK,KAAK,EAAE;IACrB;EACF;EAEA,IAAIM,CAAC,GAAGtD,4BAA4B,CAClCqD,SAAS,EACTtD,iBAAiB,CAACF,WAAW,CAC/B,CAAC;EACDyD,CAAC,GAAGA,CAAC,CAACC,GAAG,CAAC3D,sBAAsB,CAAC;IAAEE,UAAU;IAAED;EAAY,CAAC,CAAC,CAAC;EAC9DyD,CAAC,GAAG,IAAAE,yBAAkB,EAACF,CAAC,EAAE5E,mBAAmB,CAAC;EAC9C4E,CAAC,GAAG,IAAAE,yBAAkB,EAACF,CAAC,EAAEnE,wBAAwB,CAAC;EACnD;EACAmE,CAAC,GAAGA,CAAC,CAACC,GAAG,CAAChF,mBAAmB,CAAC;EAE9B,MAAM0B,MAAM,GAAGqD,CAAgD;EAE/D,MAAM/C,UAAU,GAAGN,MAAM,CAAC2B,KAAK,CAAC,CAAE;EAElCc,SAAS,CAAC,6BAA6B,EAAEnC,UAAU,CAAC;EACpD,IAAIkD,aAAa,GAAGlD,UAAU;EAC9B,KAAK,MAAM/B,KAAK,IAAIyB,MAAM,EAAE;IAC1B,MAAMyD,eAAe,GACnBD,aAAa,CAAChF,WAAW,CAACS,KAAK,KAAKV,KAAK,CAACC,WAAW,CAACS,KAAK;IAE7D,IAAIwE,eAAe,EAAE;MACnBhB,SAAS,CAAC,6BAA6B,EAAElE,KAAK,CAAC;IACjD,CAAC,MAAM;MACLkE,SAAS,CAAC,uBAAuB,EAAElE,KAAK,CAAC;IAC3C;IACAiF,aAAa,GAAGjF,KAAK;EACvB;AACF;AAEO,SAASmF,kBAAkBA,CAACC,MAAc,EAAE;EACjD,MAAMC,OAAO,GAAG,IAAAC,qCAAmB,EAACF,MAAM,CAAC;EAC3C,IAAIC,OAAO,KAAK,IAAI,EAAE;IACpB,MAAM,IAAIE,KAAK,CAAC,qBAAqBH,MAAM,mBAAmB,CAAC;EACjE;EACA,OAAOC,OAAO;AAChB","ignoreList":[]}